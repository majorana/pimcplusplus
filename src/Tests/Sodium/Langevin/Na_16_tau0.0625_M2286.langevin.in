double tau=0.0625;

Section (Parallel)
{
  int ProcsPerClone = 4;
}


// This system contains 16 sodium atoms at approximate the ground state,
// and experimental lattice constant of 8.003 bohr
// Note:  energy per isolated atom for this PH is -0.195113 hartrees.
Section (System)
{
  int NumTimeSlices=2286;
  Array<bool,1> IsPeriodic(3) = [true,true,true];
  //  Array<double,1> Box(3)=[30.1766, 30.1766, 30.1766];
  Array<double,1> Box(3) = [23.951, 23.951, 23.951];
  double kCutoff = 1.3;
  Section (Particles)
  {
    Section (Species)
    {
      string Name="Na";
      string Type="Na+";
      double lambda=0.0; 
      string Statistics="BOLTZMANNON";
      string NodeType = "NONE";
      int NumParticles=16;
      int NumDim=3;
      string InitPaths="BCC";
    }
    Section (Species)
    {
      string Name="edown";
      string Type = "e";
      string Statistics = "FERMION";
      double lambda=0.5; 
      string NodeType = "FIXEDPHASE";
      int NumParticles=8;
      int NumDim=3;
      string InitPaths="LEVIFLIGHT";
      Array<double,2> Positions(8,3)=
        [ -8.73103005, -8.5150300, -8.630300,
	  -8.3303008, -8.2660300,   0.920000,
	  -8.2303001,   0.7330000, -8.5420300,
            0.4700003, -8.9460300, -8.1340300,
	  -8.5303004,   0.8260000,   0.2520000,
            0.63500007, -8.1260300,   0.721067000,
            0.71200003,   0.6026000, -8.230300,
            0.80780001,   0.22012000,   0.5520000 ];
      
    }
    Section (Species)
    {
      string Name="eup";
      string Type="e";
      double lambda=0.5; 
      string Statistics="FERMION";
      string NodeType = "FIXEDPHASE";
      int NumParticles=8;
      int NumDim=3;
      string InitPaths="LEVIFLIGHT";
      Array<double,2> Positions(8,3)=
	[ -4.350146, -4.332014, -4.262014,
          -4.120141,  4.923014, -4.336014,
          -4.410143, -4.73014,  4.808414,
          -4.160148,  4.9123014,  4.544014,
           4.580142, -4.832014, -4.366014,
           4.920145, -4.563014,  4.732014,
           4.250145,  4.345014, -4.2866014,
           4.620141,  4.53014,  4.784014 ];
    }
  }
}


Section (Action)
{
  int MaxLevels = 6;
  bool UseRPA = false;
  int NumBreakupKnots = 20;
  int NumImages = 0;
  Array<string,1> PairActionFiles(3) = 
    ["Na-Na.PairAction",
     "~/PairActions/NaPH_US_May9_05.fit.new.beta8.0.h5",
     "~/PairActions/e-e.fit.beta8.0.h5"];
  Section (NodalAction)
  {
    string Type = "FIXEDPHASE";
    string IonSpecies  = "Na";
    string UpSpecies   = "eup";
    string DownSpecies = "edown";
    double kCut = 4.0;
//    Array<double,1> kVec(3)  =  [ 0.04, 0.04, 0.04 ];
//     Array<double,2> TwistAngles(32,3) = [ 0.25, -0.75, -0.75,
//                                           0.25, -0.75, -0.25,
//                                           0.25, -0.75,  0.25,
//                                           0.25, -0.75,  0.75,
//                                           0.25, -0.25, -0.75,
//                                           0.25, -0.25, -0.25,
//                                           0.25, -0.25,  0.25,
//                                           0.25, -0.25,  0.75,
//                                           0.25,  0.25, -0.75,
//                                           0.25,  0.25, -0.25,
//                                           0.25,  0.25,  0.25,
//                                           0.25,  0.25,  0.75,
//                                           0.25,  0.75, -0.75,
//                                           0.25,  0.75, -0.25,
//                                           0.25,  0.75,  0.25,
//                                           0.25,  0.75,  0.75,
//                                           0.75, -0.75, -0.75,
//                                           0.75, -0.75, -0.25,
//                                           0.75, -0.75,  0.25,
//                                           0.75, -0.75,  0.75,
//                                           0.75, -0.25, -0.75,
//                                           0.75, -0.25, -0.25,
//                                           0.75, -0.25,  0.25,
//                                           0.75, -0.25,  0.75,
//                                           0.75,  0.25, -0.75,
//                                           0.75,  0.25, -0.25,
//                                           0.75,  0.25,  0.25,
//                                           0.75,  0.25,  0.75,
//                                           0.75,  0.75, -0.75,
//                                           0.75,  0.75, -0.25,
//                                           0.75,  0.75,  0.25,
//                                           0.75,  0.75,  0.75 ];
    Array<double,2> TwistAngles(8,3) = [  0.25,  0.25,  0.25,
                                          0.25,  0.25,  0.75,
					  0.25,  0.75,  0.25,
                                          0.25,  0.75,  0.75,
					  0.75,  0.25,  0.25,
                                          0.75,  0.25,  0.75,
                                          0.75,  0.75,  0.25,
                                          0.75,  0.75,  0.75 ];
  }
  bool UseBackground = false;
}

Section (Observables)
{
  string OutFileBase="~/Runs/NaRuns/Na_16_tau0.0625_M2286.langevin.turing";
  int FileStart = 0;
  Section (Observable) {
    string type = "Energy";
    string Name = "Energy";
    int freq=5;
    int dumpFreq=100;
    
  }
  Section (Observable) {
    string type = "PairCorrelation";
    string Name = "Na-eup";
    string Species1 = "Na";
    string Species2 = "eup";
    int freq=5;
    int dumpFreq=100;
    Section (Grid) {
      string type = "Linear";
      int NumPoints = 200;
    }
  }
  Section (Observable) {
    string type = "PairCorrelation";
    string Name = "Na-edown";
    string Species1 = "Na";
    string Species2 = "edown";
    int freq=5;
    int dumpFreq=100;
    Section (Grid) {
      string type = "Linear";
      int NumPoints = 200;
    }
  }
  Section (Observable) {
    string type = "PairCorrelation";
    string Name = "eup-eup";
    string Species1 = "eup";
    string Species2 = "eup";
    int freq=5;
    int dumpFreq=100;
    Section (Grid) {
      string type = "Linear";
      int NumPoints = 200;
    }
  }
  Section (Observable) {
    string type = "PairCorrelation";
    string Name = "eup-edown";
    string Species1 = "eup";
    string Species2 = "edown";
    int freq=5;
    int dumpFreq=100;
    Section (Grid) {
      string type = "Linear";
      int NumPoints = 200;
    }
  }
  Section (Observable) {
    string type = "PairCorrelation";
    string Name = "edown-edown";
    string Species1 = "edown";
    string Species2 = "edown";
    int freq=5;
    int dumpFreq=100;
    Section (Grid) {
      string type = "Linear";
      int NumPoints = 200;
    }
  }
  Section (Observable) {
    string type = "PairCorrelation";
    string Name = "Na-Na";
    string Species1 = "Na";
    string Species2 = "Na";
    int freq=5;
    int dumpFreq=100;
    Section (Grid) {
      string type = "Linear";
      int NumPoints = 200;
    }
  }
//   Section (Observable) {
//     string type = "PathDump";
//     string Name = "PathDump";
//     int dumpFreq = 2;
//   }
}


Section (Moves) {
  Section (Move) {
    string type="BisectionBlock";
    string name="eupBlock";
    //string PermuteType="TABLE";
    string PermuteType="NONE";
    Array<double,1> Gamma(4) = [1.0, 1.0, 1.0, 1.0];
    int NumLevels=6;
    string Species = "eup";
    int StepsPerBlock=8;
  }
  Section (Move) {
    string type="BisectionBlock";
    string name="edownBlock";
    string PermuteType="NONE";
    //string PermuteType="TABLE";
    Array<double,1> Gamma(4) = [1.0, 1.0, 1.0, 1.0];
    int NumLevels=6;
    string Species = "edown";
    int StepsPerBlock=8;
  }
  Section (Move) {
    string type="ShiftMove";
    string name="Shift";
  }
  Section (Move) {
    string type="Langevin";
    string name="Langevin";
    double Mass = 1.0;
    double TimeStep = 0.01;
    int NumEquilSteps = 10;
    int NumAccumSteps = 100;
    string Species="Na";
  }
}

 


Section (Algorithm) {
  ////////////////////////
  // Equilibration loop //
  ////////////////////////
//   Section (Loop) { 
//     int steps=1000;
//     Section (Loop) {
//       int steps=1;
//       Section (Loop) {
//         int steps=2;
//         Section (Move) { string name="eupBlock";} 
//         Section (Move) { string name="edownBlock";} 
//       }
//       Section (Move) { string name = "Shift"; }
//     }
//   }

  Section (Loop) { //Start Accumulating observables
    int steps=6000000;
    Section (Loop){
      int steps=9;
      Section (Loop){
        int steps=2;
        Section (Move) { string name="eupBlock";     } 
        Section (Move) { string name="edownBlock";   } 
      }
      Section (Move)   { string name = "Shift";      }
    }
    Section (Move)     { string name = "Langevin";   }
    Section (Observe)  { string name = "Na-eup";     }
    Section (Observe)  { string name = "Na-edown";   }
    Section (Observe)  { string name = "eup-eup";    }
    Section (Observe)  { string name = "edown-edown";}
    Section (Observe)  { string name = "eup-edown";  }
    Section (Observe)  {  string name = "Na-Na";     }
    Section (Observe)  { string name = "Energy";     }
//    Section (Observe) { string name = "PathDump"; }
  }
}




	  
